{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "3c9f7bd8",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "\n",
    "from sklearn.preprocessing import LabelEncoder\n",
    "\n",
    "\n",
    "from sklearn.metrics import accuracy_score\n",
    "from sklearn.metrics import plot_confusion_matrix\n",
    "from sklearn.metrics import classification_report\n",
    "\n",
    "from sklearn.model_selection import GridSearchCV\n",
    "import joblib\n",
    "import sys\n",
    "sys.modules['sklearn.externals.joblib'] = joblib\n",
    "from mlxtend.feature_selection import SequentialFeatureSelector as SFS\n",
    "from sklearn.svm import SVC\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "2dcdeb50",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>duration</th>\n",
       "      <th>protocol_type</th>\n",
       "      <th>service</th>\n",
       "      <th>flag</th>\n",
       "      <th>src_bytes</th>\n",
       "      <th>dst_bytes</th>\n",
       "      <th>land</th>\n",
       "      <th>wrong_fragment</th>\n",
       "      <th>urgent</th>\n",
       "      <th>hot</th>\n",
       "      <th>...</th>\n",
       "      <th>dst_host_srv_count</th>\n",
       "      <th>dst_host_same_srv_rate</th>\n",
       "      <th>dst_host_diff_srv_rate</th>\n",
       "      <th>dst_host_same_src_port_rate</th>\n",
       "      <th>dst_host_srv_diff_host_rate</th>\n",
       "      <th>dst_host_serror_rate</th>\n",
       "      <th>dst_host_srv_serror_rate</th>\n",
       "      <th>dst_host_rerror_rate</th>\n",
       "      <th>dst_host_srv_rerror_rate</th>\n",
       "      <th>label</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "      <td>udp</td>\n",
       "      <td>private</td>\n",
       "      <td>SF</td>\n",
       "      <td>105</td>\n",
       "      <td>146</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>254</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>udp</td>\n",
       "      <td>private</td>\n",
       "      <td>SF</td>\n",
       "      <td>105</td>\n",
       "      <td>146</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>254</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>udp</td>\n",
       "      <td>private</td>\n",
       "      <td>SF</td>\n",
       "      <td>105</td>\n",
       "      <td>146</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>254</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>udp</td>\n",
       "      <td>private</td>\n",
       "      <td>SF</td>\n",
       "      <td>105</td>\n",
       "      <td>146</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>254</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0</td>\n",
       "      <td>udp</td>\n",
       "      <td>private</td>\n",
       "      <td>SF</td>\n",
       "      <td>105</td>\n",
       "      <td>146</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>255</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 42 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   duration protocol_type  service flag  src_bytes  dst_bytes land  \\\n",
       "1         0           udp  private   SF        105        146  0.0   \n",
       "2         0           udp  private   SF        105        146  0.0   \n",
       "3         0           udp  private   SF        105        146  0.0   \n",
       "4         0           udp  private   SF        105        146  0.0   \n",
       "5         0           udp  private   SF        105        146  0.0   \n",
       "\n",
       "  wrong_fragment urgent  hot  ...  dst_host_srv_count dst_host_same_srv_rate  \\\n",
       "1            0.0    0.0  0.0  ...                 254                    1.0   \n",
       "2            0.0    0.0  0.0  ...                 254                    1.0   \n",
       "3            0.0    0.0  0.0  ...                 254                    1.0   \n",
       "4            0.0    0.0  0.0  ...                 254                    1.0   \n",
       "5            0.0    0.0  0.0  ...                 255                    1.0   \n",
       "\n",
       "   dst_host_diff_srv_rate dst_host_same_src_port_rate  \\\n",
       "1                    0.01                        0.00   \n",
       "2                    0.01                        0.00   \n",
       "3                    0.01                        0.00   \n",
       "4                    0.01                        0.01   \n",
       "5                    0.00                        0.01   \n",
       "\n",
       "  dst_host_srv_diff_host_rate  dst_host_serror_rate  dst_host_srv_serror_rate  \\\n",
       "1                         0.0                   0.0                       0.0   \n",
       "2                         0.0                   0.0                       0.0   \n",
       "3                         0.0                   0.0                       0.0   \n",
       "4                         0.0                   0.0                       0.0   \n",
       "5                         0.0                   0.0                       0.0   \n",
       "\n",
       "  dst_host_rerror_rate dst_host_srv_rerror_rate label  \n",
       "1                  0.0                      0.0     0  \n",
       "2                  0.0                      0.0     0  \n",
       "3                  0.0                      0.0     1  \n",
       "4                  0.0                      0.0     1  \n",
       "5                  0.0                      0.0     1  \n",
       "\n",
       "[5 rows x 42 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#loading the dataset\n",
    "\n",
    "df = pd.read_pickle('Group_1_data_cleaned.pkl')\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "6ce2c233",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 274650 entries, 1 to 311028\n",
      "Data columns (total 42 columns):\n",
      " #   Column                       Non-Null Count   Dtype   \n",
      "---  ------                       --------------   -----   \n",
      " 0   duration                     274650 non-null  int64   \n",
      " 1   protocol_type                274650 non-null  category\n",
      " 2   service                      274650 non-null  category\n",
      " 3   flag                         274650 non-null  category\n",
      " 4   src_bytes                    274650 non-null  int64   \n",
      " 5   dst_bytes                    274650 non-null  int64   \n",
      " 6   land                         274650 non-null  category\n",
      " 7   wrong_fragment               274650 non-null  category\n",
      " 8   urgent                       274650 non-null  category\n",
      " 9   hot                          274650 non-null  float64 \n",
      " 10  num_failed_logins            274650 non-null  float64 \n",
      " 11  logged_in                    274650 non-null  category\n",
      " 12  num_compromised              274650 non-null  float64 \n",
      " 13  root_shell                   274650 non-null  category\n",
      " 14  su_attempted                 274650 non-null  category\n",
      " 15  num_root                     274650 non-null  float64 \n",
      " 16  num_file_creations           274650 non-null  float64 \n",
      " 17  num_shells                   274650 non-null  category\n",
      " 18  num_access_files             274650 non-null  category\n",
      " 19  num_outbound_cmds            274650 non-null  category\n",
      " 20  is_host_login                274650 non-null  category\n",
      " 21  is_guest_login               274650 non-null  category\n",
      " 22  count                        274650 non-null  int64   \n",
      " 23  srv_count                    274650 non-null  float64 \n",
      " 24  serror_rate                  274650 non-null  float64 \n",
      " 25  srv_serror_rate              274650 non-null  float64 \n",
      " 26  rerror_rate                  274650 non-null  float64 \n",
      " 27  srv_rerror_rate              274650 non-null  float64 \n",
      " 28  same_srv_rate                274650 non-null  float64 \n",
      " 29  diff_srv_rate                274650 non-null  float64 \n",
      " 30  srv_diff_host_rate           274650 non-null  float64 \n",
      " 31  dst_host_count               274650 non-null  int64   \n",
      " 32  dst_host_srv_count           274650 non-null  int64   \n",
      " 33  dst_host_same_srv_rate       274650 non-null  float64 \n",
      " 34  dst_host_diff_srv_rate       274650 non-null  float64 \n",
      " 35  dst_host_same_src_port_rate  274650 non-null  float64 \n",
      " 36  dst_host_srv_diff_host_rate  274650 non-null  float64 \n",
      " 37  dst_host_serror_rate         274650 non-null  float64 \n",
      " 38  dst_host_srv_serror_rate     274650 non-null  float64 \n",
      " 39  dst_host_rerror_rate         274650 non-null  float64 \n",
      " 40  dst_host_srv_rerror_rate     274650 non-null  float64 \n",
      " 41  label                        274650 non-null  category\n",
      "dtypes: category(15), float64(21), int64(6)\n",
      "memory usage: 62.6 MB\n"
     ]
    }
   ],
   "source": [
    "df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "add4596f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>duration</th>\n",
       "      <th>protocol_type</th>\n",
       "      <th>service</th>\n",
       "      <th>flag</th>\n",
       "      <th>src_bytes</th>\n",
       "      <th>dst_bytes</th>\n",
       "      <th>land</th>\n",
       "      <th>wrong_fragment</th>\n",
       "      <th>urgent</th>\n",
       "      <th>hot</th>\n",
       "      <th>...</th>\n",
       "      <th>dst_host_srv_count</th>\n",
       "      <th>dst_host_same_srv_rate</th>\n",
       "      <th>dst_host_diff_srv_rate</th>\n",
       "      <th>dst_host_same_src_port_rate</th>\n",
       "      <th>dst_host_srv_diff_host_rate</th>\n",
       "      <th>dst_host_serror_rate</th>\n",
       "      <th>dst_host_srv_serror_rate</th>\n",
       "      <th>dst_host_rerror_rate</th>\n",
       "      <th>dst_host_srv_rerror_rate</th>\n",
       "      <th>label</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>45</td>\n",
       "      <td>4</td>\n",
       "      <td>105</td>\n",
       "      <td>146</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>254</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>45</td>\n",
       "      <td>4</td>\n",
       "      <td>105</td>\n",
       "      <td>146</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>254</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>45</td>\n",
       "      <td>4</td>\n",
       "      <td>105</td>\n",
       "      <td>146</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>254</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>45</td>\n",
       "      <td>4</td>\n",
       "      <td>105</td>\n",
       "      <td>146</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>254</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>45</td>\n",
       "      <td>4</td>\n",
       "      <td>105</td>\n",
       "      <td>146</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>255</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 42 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   duration  protocol_type  service  flag  src_bytes  dst_bytes  land  \\\n",
       "1         0              2       45     4        105        146     0   \n",
       "2         0              2       45     4        105        146     0   \n",
       "3         0              2       45     4        105        146     0   \n",
       "4         0              2       45     4        105        146     0   \n",
       "5         0              2       45     4        105        146     0   \n",
       "\n",
       "   wrong_fragment  urgent  hot  ...  dst_host_srv_count  \\\n",
       "1               0       0  0.0  ...                 254   \n",
       "2               0       0  0.0  ...                 254   \n",
       "3               0       0  0.0  ...                 254   \n",
       "4               0       0  0.0  ...                 254   \n",
       "5               0       0  0.0  ...                 255   \n",
       "\n",
       "   dst_host_same_srv_rate  dst_host_diff_srv_rate  \\\n",
       "1                     1.0                    0.01   \n",
       "2                     1.0                    0.01   \n",
       "3                     1.0                    0.01   \n",
       "4                     1.0                    0.01   \n",
       "5                     1.0                    0.00   \n",
       "\n",
       "   dst_host_same_src_port_rate  dst_host_srv_diff_host_rate  \\\n",
       "1                         0.00                          0.0   \n",
       "2                         0.00                          0.0   \n",
       "3                         0.00                          0.0   \n",
       "4                         0.01                          0.0   \n",
       "5                         0.01                          0.0   \n",
       "\n",
       "   dst_host_serror_rate  dst_host_srv_serror_rate  dst_host_rerror_rate  \\\n",
       "1                   0.0                       0.0                   0.0   \n",
       "2                   0.0                       0.0                   0.0   \n",
       "3                   0.0                       0.0                   0.0   \n",
       "4                   0.0                       0.0                   0.0   \n",
       "5                   0.0                       0.0                   0.0   \n",
       "\n",
       "   dst_host_srv_rerror_rate  label  \n",
       "1                       0.0      0  \n",
       "2                       0.0      0  \n",
       "3                       0.0      1  \n",
       "4                       0.0      1  \n",
       "5                       0.0      1  \n",
       "\n",
       "[5 rows x 42 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "columns = ['protocol_type','service','flag','land','wrong_fragment','urgent','logged_in','root_shell',\n",
    "                                'su_attempted','num_shells','num_access_files','num_outbound_cmds','is_host_login',\n",
    "                                'is_guest_login']\n",
    "\n",
    "for i in columns:\n",
    "    df[i] = LabelEncoder().fit_transform(df[i])\n",
    "    \n",
    "df.head()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "a03fe07b",
   "metadata": {},
   "outputs": [],
   "source": [
    "# defining target variable\n",
    "\n",
    "X = df.iloc[0:].drop('label',axis=1)\n",
    "y = df[['label']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "7d03a04b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#importing the necessary libraries\n",
    "from mlxtend.feature_selection import SequentialFeatureSelector as SFS\n",
    "from sklearn.ensemble import RandomForestClassifier\n",
    "\n",
    "\n",
    "# Sequential Forward Selection(sfs)\n",
    "sffs = SFS(RandomForestClassifier(),\n",
    "          k_features=(3,11),\n",
    "          forward=True,\n",
    "          floating=True,\n",
    "          scoring = 'accuracy',\n",
    "          cv = 0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "72d24ed4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>SequentialFeatureSelector(cv=0, estimator=RandomForestClassifier(),\n",
       "                          floating=True, k_features=(3, 11),\n",
       "                          scoring=&#x27;accuracy&#x27;)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" ><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">SequentialFeatureSelector</label><div class=\"sk-toggleable__content\"><pre>SequentialFeatureSelector(cv=0, estimator=RandomForestClassifier(),\n",
       "                          floating=True, k_features=(3, 11),\n",
       "                          scoring=&#x27;accuracy&#x27;)</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-2\" type=\"checkbox\" ><label for=\"sk-estimator-id-2\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">estimator: RandomForestClassifier</label><div class=\"sk-toggleable__content\"><pre>RandomForestClassifier()</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-3\" type=\"checkbox\" ><label for=\"sk-estimator-id-3\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">RandomForestClassifier</label><div class=\"sk-toggleable__content\"><pre>RandomForestClassifier()</pre></div></div></div></div></div></div></div></div></div></div>"
      ],
      "text/plain": [
       "SequentialFeatureSelector(cv=0, estimator=RandomForestClassifier(),\n",
       "                          floating=True, k_features=(3, 11),\n",
       "                          scoring='accuracy')"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sffs.fit(X, y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "2b164774",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "('duration',\n",
       " 'src_bytes',\n",
       " 'dst_bytes',\n",
       " 'srv_count',\n",
       " 'dst_host_count',\n",
       " 'dst_host_srv_count',\n",
       " 'dst_host_same_src_port_rate')"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sffs.k_feature_names_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "c4f0b17a",
   "metadata": {},
   "outputs": [],
   "source": [
    "X = df[['duration',\n",
    " 'src_bytes',\n",
    " 'dst_bytes',\n",
    " 'srv_count',\n",
    " 'dst_host_count',\n",
    " 'dst_host_srv_count',\n",
    " 'dst_host_same_src_port_rate']]\n",
    "y= df[['label']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "45cdd6fb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#splitting the data into train-test\n",
    "\n",
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "5f0250e6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-2\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>RandomForestClassifier()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-4\" type=\"checkbox\" checked><label for=\"sk-estimator-id-4\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">RandomForestClassifier</label><div class=\"sk-toggleable__content\"><pre>RandomForestClassifier()</pre></div></div></div></div></div>"
      ],
      "text/plain": [
       "RandomForestClassifier()"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.model_selection import train_test_split, RandomizedSearchCV, GridSearchCV\n",
    "from sklearn.metrics import accuracy_score, classification_report\n",
    "from sklearn.tree import DecisionTreeClassifier\n",
    "from sklearn.ensemble import RandomForestClassifier\n",
    "\n",
    "#implementing random forest classifier\n",
    "forest = RandomForestClassifier()\n",
    "forest.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "890d70e9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([1, 1, 1, ..., 1, 1, 1], dtype=int64)"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_pred = forest.predict(X_test)\n",
    "y_pred"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "36874e14",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Accuracy: 0.9788\n"
     ]
    }
   ],
   "source": [
    "print('Accuracy: {:.4f}'.format(accuracy_score(y_test, y_pred)))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "f6fbf34b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.95      0.94      0.94     12913\n",
      "           1       0.99      0.99      0.99     55750\n",
      "\n",
      "    accuracy                           0.98     68663\n",
      "   macro avg       0.97      0.96      0.97     68663\n",
      "weighted avg       0.98      0.98      0.98     68663\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(classification_report(y_test, y_pred))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "e881bb1c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.rcParams[\"figure.figsize\"] = [5, 5]\n",
    "\n",
    "fig = plot_confusion_matrix(forest, X_test, y_test, display_labels=forest.classes_)\n",
    "fig.figure_.suptitle(\"Confusion Matrix\")\n",
    "\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "c9d15e2d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'max_depth': 90, 'max_features': 'log2', 'n_estimators': 30}\n",
      "0.9786297189024266\n"
     ]
    }
   ],
   "source": [
    "rfc = RandomForestClassifier()\n",
    "\n",
    "k_fold = RepeatedStratifiedKFold(n_splits=3,\n",
    "                                 n_repeats=1, \n",
    "                                 random_state=8)\n",
    "\n",
    "\n",
    "random_grid = {\"n_estimators\": range(10, 201, 20),\n",
    "               \"max_features\": [\"sqrt\", \"log2\"],\n",
    "               \"max_depth\": range(10, 101, 20)\n",
    "              }\n",
    "\n",
    "rfc_rs = GridSearchCV(rfc, \n",
    "                            param_grid = random_grid,\n",
    "                            cv = k_fold, \n",
    "                            n_jobs = 10, \n",
    "                            scoring = \"accuracy\")\n",
    "\n",
    "rfc_rs.fit(X_train, y_train)\n",
    "\n",
    "#best parameters from gridsearchCV\n",
    "print(rfc_rs.best_params_)\n",
    "\n",
    "print(rfc_rs.best_score_)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "98ab337e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style>#sk-container-id-3 {color: black;background-color: white;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-3\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>RandomForestClassifier(max_depth=90, max_features=&#x27;log2&#x27;, n_estimators=30)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-5\" type=\"checkbox\" checked><label for=\"sk-estimator-id-5\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">RandomForestClassifier</label><div class=\"sk-toggleable__content\"><pre>RandomForestClassifier(max_depth=90, max_features=&#x27;log2&#x27;, n_estimators=30)</pre></div></div></div></div></div>"
      ],
      "text/plain": [
       "RandomForestClassifier(max_depth=90, max_features='log2', n_estimators=30)"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "forest = RandomForestClassifier(max_depth = 90, max_features = 'log2', n_estimators= 30)\n",
    "forest.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "071f1b07",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([1, 1, 1, ..., 1, 1, 1], dtype=int64)"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#prediction\n",
    "y_pred = forest.predict(X_test)\n",
    "y_pred"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "2a26d821",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Accuracy: 0.9788\n"
     ]
    }
   ],
   "source": [
    "print('Accuracy: {:.4f}'.format(accuracy_score(y_test, y_pred)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "f36d4202",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "           0       0.95      0.94      0.94     12913\n",
      "           1       0.99      0.99      0.99     55750\n",
      "\n",
      "    accuracy                           0.98     68663\n",
      "   macro avg       0.97      0.96      0.97     68663\n",
      "weighted avg       0.98      0.98      0.98     68663\n",
      "\n"
     ]
    }
   ],
   "source": [
    "#classification report\n",
    "print(classification_report(y_test, y_pred))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "940f566d",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
